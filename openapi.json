{
  "openapi": "3.0.3",
  "info": {
    "title": "Pokétroc",
    "description": "Application qui permet aux utilisateurs de lister leurs cartes pokémon, de les échanger ainsi que de chercher des cartes qu’ils aimeraient acquérir.",
    "version": "1.1.0",
    "contact": { "url": "https://github.com/nicolaswunderle/poketroc" }
  },
  "servers": [{ "url": "https://poketroc.onrender.com/api"}],
  "tags": [
    {
      "name": "dresseur",
      "description": ""
    },
    {
      "name": "carte",
      "description": ""
    },
    {
      "name": "échange",
      "description": ""
    },
    {
      "name": "message",
      "description": ""
    }
  ],
  "paths": {
    "/poketroc/deck/carte": {
      "get": {
        "summary": "Afficher carte dresseur-----------------------------------------------------",
        "tags": ["carte"],
        "parameters": [
          {
            "name": "carteId",
            "in": "path",
            "description": "Identifiant de la carte",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "La carte a été affichée",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Carte"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/CartePasTrouvee"
          }
        }
      },
      "post": {
        "summary": "Echanger carte-----------------------------------------------",
        "tags": ["carte"],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CarteData"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Echange réussi",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Carte"
                }
              }
            }
          },
          "422": {
            "$ref": "#/components/responses/CarteValidationErreur"
          }
        }
      },
      "patch": {
        "summary": "Modifier carte du dresseur en partie---------------------------------------",
        "tags": ["carte"],
        "parameters": [
          {
            "name": "carteId",
            "in": "path",
            "description": "Identifiant de la carte",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CarteDataPartiel"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Carte"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/CartePasTrouvee"
          }
        }
      },
      "delete": {
        "summary": "Supprimer carte-------------------------------------------------------------",
        "tags": ["carte"],
        "parameters": [
          {
            "name": "carteId",
            "in": "path",
            "description": "Identifiant de la carte",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "La carte a été correctement supprimée"
          },
          "404": {
            "$ref": "#/components/responses/CartePasTrouvee"
          }
        }
      }
    },
    "/dresseurs/connection": {},
    "/dresseurs": {
      "post": {
        "summary": "Inscription à l'application-----------------------------------------------",
        "tags": ["dresseur"],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DresseurData"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Inscription réussie",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Dresseur"
                }
              }
            }
          }
        }
      }
    },
    "/dresseurs/connexion": {
      "post": {
        "summary": "Connexion au compte dresseur-----------------------------------------------",
        "tags": ["dresseur"],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/connexion",
                "type": "object",
                "properties": {
                  "pseudo": {
                    "type": "string",
                    "description": "Le pseudo du dresseur",
                    "example": "Nerak"
                  },
                  "mot_de_passe": {
                    "type": "string",
                    "description": "Le mot de passe du compte dresseur",
                    "example": "unMotDePasse88"
                  }
                },
                "required": ["pseudo", "mot_de_passe"]             
              }
            }
          }
        },
      "responses": {
        "200": {
          "description": "Connexion réussie",
          "content": {}
        },
        "401": {
          "description": "Échec de l'authentification",
          "content": {}
        } 
      }
  },
      "delete": {
        "summary": "Deconnexion au compte dresseur-----------------------------------------------",
        "tags": ["dresseur"],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/connexion",
                "type": "object",
                "properties": {
                  "pseudo": {
                   "type": "string",
                    "description": "Le pseudo du dresseur",
                    "example": "Nerak"
                  },
                  "mot_de_passe": {
                    "type": "string",
                    "description": "Le mot de passe du compte dresseur",
                    "example": "unMotDePasse88"
                  }
                },
              "required": ["pseudo", "mot_de_passe"]             
              }
            }
          }
        },
    "responses": {
      "200": {
        "description": "Déconnexion réussie",
        "content": {}
      } 
    }
  }
},

    "poketroc/profil": {
      "get": {
        "summary": "Afficher profil dresseur-----------------------------------------------------",
        "tags": ["dresseur"],
        "parameters": [
          {
            "name": "dresseurId",
            "in": "path",
            "description": "Identifiant du dresseur",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Le profil à été affiché",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Dresseur"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Supprimer profil-------------------------------------------------------------",
        "tags": ["dresseur"],
        "securitySchemes": ["JWT"],
        "parameters": [
          {
            "name": "dresseurId",
            "in": "path",
            "description": "",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Le dresseur à été supprimé"
          }
        }
      }
    },
    "poketroc/profil/modification/mot-de-passe": {
      "put": {
        "summary": "Modifier le mot de passe-----------------------------------------------------",
        "tags": ["dresseur"]
      }
    },
    "poketroc/profil/modification": {
      "put": {
        "summary": "Modifier profil du dresseur en entier---------------------------------------",
        "tags": ["dresseur"],
        "parameters": [
          {
            "name": "dresseurId",
            "in": "path",
            "description": "Identifiant du dresseur",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DresseurData"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Dresseur"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Modifier profil du dresseur en partie---------------------------------------",
        "tags": ["dresseur"],
        "parameters": [
          {
            "name": "dresseurId",
            "in": "path",
            "description": "Identifiant du dresseur",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DresseurDataPartiel"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Dresseur"
                }
              }
            }
          }
        }
      }
    },
    "poketroc/deck": {
      "get": {
        "summary": "Afficher le deck du dresseur-------------------------------------------------",
        "tags": ["carte"],
        "parameters": [
          {
            "name": "num_carte",
            "in": "query",
            "description": "",
            "schema": {
              "type": "integer",
              "example": 114,
              "minimum": 0,
              "maximum": 1000
            }
          },
          {
            "name": "quantite",
            "in": "query",
            "description": "",
            "schema": {
              "type": "integer",
              "example": 1
            }
          },
          {
            "name": "série",
            "in": "query",
            "description": "",
            "schema": {
              "type": "string",
              "enum": [
                "écarlate et violet",
                "épée et bouclier",
                "soleil et lune",
                "xy",
                "noir et blanc"
              ],
              "example": "xy"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Carte"
                  }
                }
              }
            }
          }
        }
      }
    },
    "poketroc/fil-actualite": {
      "get": {
        "summary": "Afficher le fil d'actualité--------------------------------------------------",
        "tags": ["échange"],
        "parameters": [
          {
            "name": "ville",
            "in": "query",
            "description": "Trier les échange par ville",
            "schema": {
              "type": "string",
              "example": "Genève"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Les échanges on bien été affiché",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Echange"
                  }
                }
              }
            }
          }
        }
      }
    },
    "poketroc/fil-actualite/echange": {
      "delete": {
        "summary": "Supprimer un échange-----------------------------------------------------------",
        "tags": ["échange"],
        "parameters": [
          {
            "name": "echangeId",
            "in": "path",
            "description": "",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "L'échange à été supprimé"
          }
        }
      }
    },
    "poketroc/echange/proposition": {
      "post": {
        "summary": "Envoyer une proposition--------------------------------------------------------",
        "tags": ["échange"],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EchangeData"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Echange"
                }
              }
            }
          }
        }
      }
    },

    "messages/{echangeId}": {
      "get": {
        "summary": "Afficher tous les messages d'un échange-----------------------------------------------------------",
        "tags": ["message"],
        "parameters": [
          {
            "name": "messageId",
            "in": "path",
            "description": "Conversation d'un échange.",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Message trouvé.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Message"
                }
              }
            }
          },
          "404": {
            "description": "Message non trouvé."
          }
        }
      }
    },


    "messages/{messageId}":{
      "delete": {
        "summary": "Supprimer un message-----------------------------------------------------------",
        "tags": ["message"],
        "parameters": [
          {
            "name": "messageId",
            "in": "path",
            "description": "Le message a supprimer.",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Le message à été supprimé avec succès."
          },
          "404": {
            "description": "Message non trouvé."       
        }
      }
    },


      "get": {
        "summary": "Afficher conversations-----------------------------------------------------",
        "tags": ["message"],
        "parameters": [
          {
            "name": "pseudo",
            "in": "query",
            "description": "Affichage du message.",
            "schema": {
              "type": "string",
              "example": "AniraC"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Message"
                  }
                }
              }
            }
          }
        }
      }
    },


    "messages": {
      "post": {
        "summary": "Créer un message-----------------------------------------------------------",
        "tags": ["message"],
        "requestBody": {
          "description": "Le message à créer.",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Message",
                "type": "object",
                "properties": {
                  "contenu": {
                    "type": "string",
                    "description": "Le contenu du message",
                    "example": "Salut! Cette carte m'intéresse."
                  },
                  "expéditeur": {
                    "type": "string",
                    "description": "L'expéditeur du message.",
                    "example": "Salocin"
                  },
                  "destinataire": {
                    "type": "string",
                    "description": "Le destinataire du message.",
                    "example": "Enirehtac"
                  }
                },
                "required": ["contenu", "expéditeur", "destinataire"]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Message créé avec succès.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Message"
                }
              }
            }
          },
          "404": {
            "description": "Destinataire manquant.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MessageValidationErreur"
                }
              }
            }
          }  
        }
      }
    }
  },





  "components": {
    "responses": {
      "DresseurIntrouvable": {
        "description": "Ce-tte dresseu-r-euse n'existe pas"
      }
    },
    "schemas": {
      "Dresseur": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "",
            "example": "7fe91a9a41bc839033eedf0f"
          },
          "nom": {
            "type": "string",
            "description": "",
            "minlength": 3,
            "maxlength": 40,
            "example": "Fonseca"
          },
          "prenom": {
            "type": "string",
            "description": "",
            "minlength": 3,
            "maxlength": 15,
            "example": "Carina"
          },
          "pseudo": {
            "type": "string",
            "description": "",
            "example": "AniraC"
          },
          "email": {
            "type": "string",
            "description": "",
            "example": "adresse@email.ch"
          },
          "mot_de_passe": {
            "type": "string",
            "description": "",
            "example": "unMotDePasse32"
          },
          "age": {
            "type": "integer",
            "description": "",
            "minimum": 0,
            "maximum": 100,
            "example": 25
          },
          "ville": {
            "type": "string",
            "description": "",
            "example": "Genève"
          }
        },
        "required": [
          "id",
          "nom",
          "prenom",
          "pseudo",
          "email",
          "mot_de_passe",
          "age",
          "ville"
        ]
      },
      "DresseurData": {
        "type": "object",
        "properties": {
          "nom": {
            "type": "string",
            "description": "",
            "minlength": 3,
            "maxlength": 40,
            "example": "Fonseca"
          },
          "prenom": {
            "type": "string",
            "description": "",
            "minlength": 3,
            "maxlength": 15,
            "example": "Carina"
          },
          "pseudo": {
            "type": "string",
            "description": "",
            "example": "AniraC"
          },
          "email": {
            "type": "string",
            "description": "",
            "example": "adresse@email.ch"
          },
          "mot_de_passe": {
            "type": "string",
            "description": "",
            "example": "unMotDePasse32"
          },
          "age": {
            "type": "number",
            "description": "",
            "minimum": 0,
            "maximum": 100,
            "example": 25
          },
          "ville": {
            "type": "string",
            "description": "",
            "example": "Genève"
          }
        },
        "required": ["pseudo", "email", "mot_de_passe"]
      },
      "DresseurDataPartiel": {
        "type": "object",
        "properties": {
          "nom": {
            "type": "string",
            "description": "",
            "minlength": 3,
            "maxlength": 40,
            "example": "Fonseca"
          },
          "prenom": {
            "type": "string",
            "description": "",
            "minlength": 3,
            "maxlength": 15,
            "example": "Carina"
          },
          "pseudo": {
            "type": "string",
            "description": "",
            "example": "AniraC"
          },
          "email": {
            "type": "string",
            "description": "",
            "example": "adresse@email.ch"
          },
          "mot_de_passe": {
            "type": "string",
            "description": "",
            "example": "unMotDePasse32"
          },
          "age": {
            "type": "number",
            "description": "",
            "minimum": 0,
            "maximum": 100,
            "example": 25
          },
          "ville": {
            "type": "string",
            "description": "",
            "example": "Genève"
          }
        }
      },
      "Carte": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "",
            "example": "7fe91a9a41bc839033eedf0f"
          },
          "num_carte": {
            "type": "integer",
            "description": "",
            "example": 111
          },
          "etat": {
            "type": "string",
            "description": "",
            "enum": ["neuf", "occasoon", "abimée"],
            "example": "neuf"
          },
          "descr_etat": {
            "type": "string",
            "description": "",
            "exemple": "Très bonne état. Aucune éraflure"
          },
          "statut": {
            "type": "string",
            "description": "",
            "enum": ["collectée", "en échange", "souhaitée"],
            "example": "collectée"
          },
          "type": {
            "type": "string",
            "description": "",
            "enum": ["reverse", "holo", "rien"]
          },
          "quantite": {
            "type": "number",
            "description": "",
            "example": 1
          },
          "possedee_par": {
            "type": "string",
            "description": "",
            "example": "7fe91a9a41bc839033eedf0f"
          }
        },
        "required": [
          "id",
          "num_carte",
          "etat",
          "descr_etat",
          "statut",
          "type",
          "quantite",
          "possedee_par"
        ]
      },
      "CarteDataPartial": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "",
            "example": "7fe91a9a41bc839033eedf0f"
          },
          "num_carte": {
            "type": "number",
            "description": "",
            "example": 111
          },
          "etat": {
            "type": "string",
            "description": "",
            "enum": ["neuf", "occasion", "abimée"],
            "example": "neuf"
          },
          "descr_etat": {
            "type": "string",
            "description": "",
            "exemple": "Très bon état. Aucune éraflure"
          },
          "type": {
            "type": "string",
            "description": "",
            "enum": [""]
          },
          "possedee_par": {
            "type": "string",
            "description": "",
            "example": "7fe91a9a41bc839033eedf0f"
          }
        },
        "required": [
          "id",
          "num_carte",
          "etat",
          "descr_etat",
          "type",
          "possedee_par"
        ]
      },
      "CarteEchange": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "",
            "example": "7fe91a9a41bc839033eedf0f"
          },
          "num_carte": {
            "type": "number",
            "description": "",
            "example": 111
          },
          "etat": {
            "type": "string",
            "description": "",
            "enum": ["neuf", "occasion", "abimée"],
            "example": "neuf"
          },
          "descr_etat": {
            "type": "string",
            "description": "",
            "exemple": "Très bon état. Aucune éraflure"
          },
          "type": {
            "type": "string",
            "description": "",
            "enum": [""]
          },
          "possedee_par": {
            "type": "string",
            "description": "",
            "example": "7fe91a9a41bc839033eedf0f"
          },
          "ville": {
            "type": "string",
            "description": "",
            "example": "Genève"
          }
        },
        "required": [
          "id",
          "num_carte",
          "etat",
          "descr_etat",
          "type",
          "possedee_par",
          "ville"
        ]
      },
      "Echange": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "",
            "example": "7fe91a9a41bc839033eedf0f"
          },
          "etat": {
            "type": "string",
            "description": "",
            "enum": ["en coure", "fini"],
            "example": "en coure"
          },
          "creer_a": {
            "type": "string",
            "description": "",
            "format": "data-time",
            "example": "2020-01-02T10:00:00.000Z"
          },
          "creer_par": {
            "$ref": "#/components/schemas/Dresseur"
          },
          "accepte_par": {
            "$ref": "#/components/schemas/Dresseur"
          }
        },
        "required": ["id", "etat", "creer_a", "creer_par", "accepte_par"]
      },
      "EchangeData": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "",
            "example": "7fe91a9a41bc839033eedf0f"
          },
          "etat": {
            "type": "string",
            "description": "",
            "enum": ["en coure", "fini"],
            "example": "en coure"
          },
          "creer_a": {
            "type": "string",
            "description": "",
            "format": "data-time",
            "example": "2020-01-02T10:00:00.000Z"
          },
          "creer_par": {
            "$ref": "#/components/schemas/Dresseur"
          },
          "accepte_par": {
            "$ref": "#/components/schemas/Dresseur"
          }
        },
        "required": ["etat", "creer_a", "creer_par", "accepte_par"]
      },
      "Message": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "",
            "example": "7fe91a9a41bc839033eedf0f"
          },
          "date": {
            "type": "string",
            "description": "",
            "format": "data-time",
            "example": "2020-01-02T10:00:00.000Z"
          },
          "contenu": {
            "type": "string",
            "description": "",
            "example": "Salut!"
          },
          "expéditeur": {
            "type": "string",
            "description": "Celui qui envoie le message.",
            "example": "Nerak"
          },
          "destinataire": {
            "type": "string",
            "description": "Celui qui reçoit le message.",
            "example": "Salocin"
          }
        },
        "required": ["id", "date", "contenu", "destinataire", "expéditeur"]
      }
    },
    "securitySchemes": {
      "authConnexion": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "securityDefinitions": {
      "JWT": {
        "type": "apiKey",
        "in": "query",
        "name": "access_token"
      }
    }
  }
}
